<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>JJ&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Cache-to-Cache: Direct Semantic Communication Between Large Language Models


githubï¼šhttps://github.com/thu-nics/C2C


ğŸ’¡ Motivationï¼ˆåŠ¨æœº / èƒŒæ™¯ï¼‰


ç°çŠ¶ï¼šå¤š-LLM ç³»ç»Ÿé€šå¸¸é€šè¿‡ æ–‡æœ¬ï¼ˆText-to-Text, T2Tï¼‰ ç›¸äº’é€šä¿¡ â€”â€” ä¸€ä¸ªæ¨¡å‹ç”Ÿæˆæ–‡æœ¬ï¼Œå¦ä¸€ä¸ªæ¨¡å‹å†è¯»å…¥æ–‡æœ¬å¹¶å¤„ç†ã€‚è¿™ç§æ–¹å¼å­˜åœ¨çš„ä¿¡æ¯ç“¶é¢ˆï¼ˆé«˜ç»´å†…éƒ¨è¡¨ç¤ºè¢«å‹æˆæ–‡æœ¬ï¼‰ã€æ­§ä¹‰æ€§ï¼ˆè‡ªç„¶è¯­è¨€æœ¬èº«çš„æ¨¡ç³Šæ€§ï¼‰ä»¥åŠ ä¸²è¡Œè§£ç å¸¦æ¥çš„å»¶è¿Ÿ ç­‰é—®é¢˜ã€‚
é—®é¢˜ï¼šæ–‡æœ¬é€šä¿¡æ— æ³•å®Œæ•´ä¿ç•™æ¨¡å‹å†…éƒ¨çš„é«˜ç»´è¯­ä¹‰ä¿¡æ¯ï¼ˆä¾‹å¦‚ KV-Cache ä¸­çš„ rich semanticsï¼‰ï¼ŒåŒæ—¶æ–‡æœ¬é€šä¿¡éœ€è¦é€ token è§£ç ï¼Œå¢åŠ é€šä¿¡ä¸æ¨ç†å»¶è¿Ÿã€‚
æå‡ºçš„é—®é¢˜ï¼ˆæ ¸å¿ƒç ”ç©¶é—®ï¼‰ï¼šLLMä¹‹é—´èƒ½å¦â€œè¶…è¶Šæ–‡æœ¬â€ç›´æ¥é€šä¿¡ï¼Ÿèƒ½å¦é€šè¿‡å…±äº«/è½¬æ¢/èåˆ KV-Cacheï¼ˆkey/value cacheï¼‰æ¥å®ç°æ›´ä¸°å¯Œã€æ›´ä½å»¶è¿Ÿçš„è¯­ä¹‰é€šä¿¡ï¼Ÿï¼ˆæ–‡ä¸­ä»¥ â€œCan LLMs communicate beyond text?â€ ä½œæ ¸å¿ƒé©±åŠ¨ã€‚ï¼‰
ä¸»è¦è§‚å¯Ÿé©±åŠ¨ï¼šä½œè€…çš„ Oracle å®éªŒæ˜¾ç¤º
(1) åœ¨ä¸æ‰©å¤§åºåˆ—é•¿åº¦çš„å‰æä¸‹ï¼Œä¸°å¯Œ KV-Cache å¯ä»¥æå‡å›ç­”è´¨é‡ï¼›
(2) ä¸åŒæ¨¡å‹çš„ KV-Cache åœ¨è¡¨ç¤ºç©ºé—´ä¸Šæ˜¯å¯è½¬æ¢/å¯å¯¹é½çš„ï¼ˆç»è¿‡è®­ç»ƒçš„ç®€å• MLP å¯å°†ä¸€ä¸ªæ¨¡å‹çš„ KV æ˜ å°„åˆ°å¦ä¸€ä¸ªæ¨¡å‹ç©ºé—´ï¼‰ã€‚
è¿™äº›è§‚å¯Ÿæ”¯æŒç”¨ KV-Cache ä½œä¸ºé€šä¿¡åª’ä»‹çš„å¯è¡Œæ€§ã€‚


âš” Challengesï¼ˆæŒ‘æˆ˜ï¼‰


è·¨æ¨¡å‹çš„ KV-Cache è¡¨ç¤ºå·®å¼‚ï¼šä¸åŒæ¨¡å‹ï¼ˆä¸åŒæ—ã€ä¸åŒè§„æ¨¡ã€ä¸åŒ tokenizerï¼‰åœ¨åŒä¸€è¾“å…¥ä¸Šäº§ç”Ÿçš„ KV-Cache åˆ†å¸ƒå·®å¼‚æ˜¾è‘—ï¼ˆt-SNE å¯è§†åŒ–ï¼‰ã€‚å¦‚ä½•å¯é åœ°å°†ä¸€ä¸ªæ¨¡å‹çš„ cache â€œæŠ•å½±â€åˆ°å¦ä¸€ä¸ªæ¨¡å‹çš„è¯­ä¹‰ç©ºé—´å¹¶è¢«æœ‰æ•ˆåˆ©ç”¨æ˜¯æŒ‘æˆ˜ã€‚
å¯¹é½é—®é¢˜ï¼ˆtoken-level &amp; layer-levelï¼‰ï¼šä¸åŒ tokenizer äº§ç”Ÿä¸åŒ token åˆ’åˆ†ï¼Œä¸”æ¨¡å‹å±‚æ•°ä¸åŒï¼Œå¿…é¡»å¤„ç† token å¯¹é½å’Œå±‚å¯¹é½é—®é¢˜ï¼ˆé¿å…ä¿¡æ¯ä¸¢å¤±æˆ–é”™ä½æ³¨å…¥ï¼‰ã€‚æ–‡ä¸­æå‡ºäº† token è§£ç å† re-encode çš„å¯¹é½ç­–ç•¥å’Œ â€œterminal alignmentâ€ å±‚å¯¹é½ç­–ç•¥ã€‚
é¿å…ç ´åæ¥æ”¶è€…åŸæœ‰è¯­ä¹‰ï¼šç›´æ¥ç”¨åˆ«äºº cache è¦†ç›–ä¼šç ´åæ¥æ”¶æ¨¡å‹å·²æœ‰è¯­ä¹‰/ç»“æ„ï¼Œéœ€è®¾è®¡æ®‹å·®å¼ã€å¯æ§çš„èåˆæœºåˆ¶ï¼ˆå³ Fuser çš„è®¾è®¡ï¼‰ã€‚
é€‰æ‹©æ€§æ³¨å…¥ï¼ˆå“ªäº›å±‚æ³¨å…¥ã€æ³¨å…¥å¤šå°‘ï¼‰ï¼šå¹¶éæ‰€æœ‰å±‚æ³¨å…¥éƒ½æœ‰åˆ©ï¼Œå•å±‚/å¤šå±‚æ³¨å…¥æ•ˆæœå·®å¼‚æ˜æ˜¾ï¼ˆAppendix çš„å•å±‚å®éªŒæ˜¾ç¤ºæœ‰å±‚å¢ç›Šä¹Ÿæœ‰å±‚ä¸‹é™ï¼‰ï¼Œå› æ­¤éœ€è¦ learnable gate æ¥é€‰æ‹©æ³¨å…¥ä½ç½®ä¸æ¯”ä¾‹ã€‚
æ•ˆç‡ / å»¶è¿Ÿæƒè¡¡ï¼šè™½ç„¶ C2C ç›®æ ‡æ˜¯é™ä½å»¶è¿Ÿï¼Œä½†åœ¨å®ç°ä¸Šè¦ä¿è¯æŠ•å½±/èåˆæœ¬èº«ä¸ä¼šå¼•å…¥æ¯”æ–‡æœ¬é€šä¿¡æ›´é«˜çš„å¼€é”€ï¼ˆè®¾è®¡è½»é‡ Fuser å¹¶å†»ç»“ä¸»æ¨¡å‹å‚æ•°ä»¥é™ä½è®­ç»ƒ/æ¨ç†æˆæœ¬ï¼‰ã€‚


ğŸ” Observations / Analysis
">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/cache-to-cache---direct-semantic-communication-between-large-language-models/">
<link crossorigin="anonymous" href="../assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/cache-to-cache---direct-semantic-communication-between-large-language-models/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="JJ&#39;s Blog (Alt + H)">JJ&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      
    </h1>
    <div class="post-meta">

</div>
  </header> 
  <div class="post-content"><h1 id="cache-to-cache-direct-semantic-communication-between-large-language-models">Cache-to-Cache: Direct Semantic Communication Between Large Language Models<a hidden class="anchor" aria-hidden="true" href="#cache-to-cache-direct-semantic-communication-between-large-language-models">#</a></h1>
<p><img loading="lazy" src="./pic/C2C/title.png"></p>
<ul>
<li>githubï¼š<a href="https://github.com/thu-nics/C2C">https://github.com/thu-nics/C2C</a></li>
</ul>
<hr>
<h2 id="-motivationåŠ¨æœº--èƒŒæ™¯">ğŸ’¡ Motivationï¼ˆåŠ¨æœº / èƒŒæ™¯ï¼‰<a hidden class="anchor" aria-hidden="true" href="#-motivationåŠ¨æœº--èƒŒæ™¯">#</a></h2>
<p><img loading="lazy" src="./pic/C2C/figure1.png"></p>
<ul>
<li>ç°çŠ¶ï¼šå¤š-LLM ç³»ç»Ÿé€šå¸¸é€šè¿‡ <strong>æ–‡æœ¬ï¼ˆText-to-Text, T2Tï¼‰</strong> ç›¸äº’é€šä¿¡ â€”â€” ä¸€ä¸ªæ¨¡å‹ç”Ÿæˆæ–‡æœ¬ï¼Œå¦ä¸€ä¸ªæ¨¡å‹å†è¯»å…¥æ–‡æœ¬å¹¶å¤„ç†ã€‚è¿™ç§æ–¹å¼å­˜åœ¨çš„ä¿¡æ¯ç“¶é¢ˆï¼ˆé«˜ç»´å†…éƒ¨è¡¨ç¤ºè¢«å‹æˆæ–‡æœ¬ï¼‰ã€æ­§ä¹‰æ€§ï¼ˆè‡ªç„¶è¯­è¨€æœ¬èº«çš„æ¨¡ç³Šæ€§ï¼‰ä»¥åŠ <strong>ä¸²è¡Œè§£ç å¸¦æ¥çš„å»¶è¿Ÿ</strong> ç­‰é—®é¢˜ã€‚</li>
<li>é—®é¢˜ï¼šæ–‡æœ¬é€šä¿¡æ— æ³•å®Œæ•´ä¿ç•™æ¨¡å‹å†…éƒ¨çš„é«˜ç»´è¯­ä¹‰ä¿¡æ¯ï¼ˆä¾‹å¦‚ KV-Cache ä¸­çš„ rich semanticsï¼‰ï¼ŒåŒæ—¶æ–‡æœ¬é€šä¿¡éœ€è¦é€ token è§£ç ï¼Œå¢åŠ é€šä¿¡ä¸æ¨ç†å»¶è¿Ÿã€‚</li>
<li>æå‡ºçš„é—®é¢˜ï¼ˆæ ¸å¿ƒç ”ç©¶é—®ï¼‰ï¼š<strong>LLMä¹‹é—´èƒ½å¦â€œè¶…è¶Šæ–‡æœ¬â€ç›´æ¥é€šä¿¡ï¼Ÿèƒ½å¦é€šè¿‡å…±äº«/è½¬æ¢/èåˆ KV-Cacheï¼ˆkey/value cacheï¼‰æ¥å®ç°æ›´ä¸°å¯Œã€æ›´ä½å»¶è¿Ÿçš„è¯­ä¹‰é€šä¿¡ï¼Ÿ</strong>ï¼ˆæ–‡ä¸­ä»¥ â€œCan LLMs communicate beyond text?â€ ä½œæ ¸å¿ƒé©±åŠ¨ã€‚ï¼‰</li>
<li>ä¸»è¦è§‚å¯Ÿé©±åŠ¨ï¼šä½œè€…çš„ Oracle å®éªŒæ˜¾ç¤º
(1) åœ¨ä¸æ‰©å¤§åºåˆ—é•¿åº¦çš„å‰æä¸‹ï¼Œä¸°å¯Œ KV-Cache å¯ä»¥æå‡å›ç­”è´¨é‡ï¼›
(2) ä¸åŒæ¨¡å‹çš„ KV-Cache åœ¨è¡¨ç¤ºç©ºé—´ä¸Šæ˜¯å¯è½¬æ¢/å¯å¯¹é½çš„ï¼ˆç»è¿‡è®­ç»ƒçš„ç®€å• MLP å¯å°†ä¸€ä¸ªæ¨¡å‹çš„ KV æ˜ å°„åˆ°å¦ä¸€ä¸ªæ¨¡å‹ç©ºé—´ï¼‰ã€‚
è¿™äº›è§‚å¯Ÿæ”¯æŒç”¨ KV-Cache ä½œä¸ºé€šä¿¡åª’ä»‹çš„å¯è¡Œæ€§ã€‚</li>
</ul>
<hr>
<h2 id="-challengesæŒ‘æˆ˜">âš” Challengesï¼ˆæŒ‘æˆ˜ï¼‰<a hidden class="anchor" aria-hidden="true" href="#-challengesæŒ‘æˆ˜">#</a></h2>
<p><img loading="lazy" src="./pic/C2C/figure2.png"></p>
<ol>
<li><strong>è·¨æ¨¡å‹çš„ KV-Cache è¡¨ç¤ºå·®å¼‚</strong>ï¼šä¸åŒæ¨¡å‹ï¼ˆä¸åŒæ—ã€ä¸åŒè§„æ¨¡ã€ä¸åŒ tokenizerï¼‰åœ¨åŒä¸€è¾“å…¥ä¸Šäº§ç”Ÿçš„ KV-Cache åˆ†å¸ƒå·®å¼‚æ˜¾è‘—ï¼ˆt-SNE å¯è§†åŒ–ï¼‰ã€‚å¦‚ä½•å¯é åœ°å°†ä¸€ä¸ªæ¨¡å‹çš„ cache â€œæŠ•å½±â€åˆ°å¦ä¸€ä¸ªæ¨¡å‹çš„è¯­ä¹‰ç©ºé—´å¹¶è¢«æœ‰æ•ˆåˆ©ç”¨æ˜¯æŒ‘æˆ˜ã€‚</li>
<li><strong>å¯¹é½é—®é¢˜ï¼ˆtoken-level &amp; layer-levelï¼‰</strong>ï¼šä¸åŒ tokenizer äº§ç”Ÿä¸åŒ token åˆ’åˆ†ï¼Œä¸”æ¨¡å‹å±‚æ•°ä¸åŒï¼Œå¿…é¡»å¤„ç† token å¯¹é½å’Œå±‚å¯¹é½é—®é¢˜ï¼ˆé¿å…ä¿¡æ¯ä¸¢å¤±æˆ–é”™ä½æ³¨å…¥ï¼‰ã€‚æ–‡ä¸­æå‡ºäº† token è§£ç å† re-encode çš„å¯¹é½ç­–ç•¥å’Œ â€œterminal alignmentâ€ å±‚å¯¹é½ç­–ç•¥ã€‚</li>
<li><strong>é¿å…ç ´åæ¥æ”¶è€…åŸæœ‰è¯­ä¹‰</strong>ï¼šç›´æ¥ç”¨åˆ«äºº cache è¦†ç›–ä¼šç ´åæ¥æ”¶æ¨¡å‹å·²æœ‰è¯­ä¹‰/ç»“æ„ï¼Œéœ€è®¾è®¡æ®‹å·®å¼ã€å¯æ§çš„èåˆæœºåˆ¶ï¼ˆå³ Fuser çš„è®¾è®¡ï¼‰ã€‚</li>
<li><strong>é€‰æ‹©æ€§æ³¨å…¥ï¼ˆå“ªäº›å±‚æ³¨å…¥ã€æ³¨å…¥å¤šå°‘ï¼‰</strong>ï¼šå¹¶éæ‰€æœ‰å±‚æ³¨å…¥éƒ½æœ‰åˆ©ï¼Œå•å±‚/å¤šå±‚æ³¨å…¥æ•ˆæœå·®å¼‚æ˜æ˜¾ï¼ˆAppendix çš„å•å±‚å®éªŒæ˜¾ç¤ºæœ‰å±‚å¢ç›Šä¹Ÿæœ‰å±‚ä¸‹é™ï¼‰ï¼Œå› æ­¤éœ€è¦ learnable gate æ¥é€‰æ‹©æ³¨å…¥ä½ç½®ä¸æ¯”ä¾‹ã€‚</li>
<li><strong>æ•ˆç‡ / å»¶è¿Ÿæƒè¡¡</strong>ï¼šè™½ç„¶ C2C ç›®æ ‡æ˜¯é™ä½å»¶è¿Ÿï¼Œä½†åœ¨å®ç°ä¸Šè¦ä¿è¯æŠ•å½±/èåˆæœ¬èº«ä¸ä¼šå¼•å…¥æ¯”æ–‡æœ¬é€šä¿¡æ›´é«˜çš„å¼€é”€ï¼ˆè®¾è®¡è½»é‡ Fuser å¹¶å†»ç»“ä¸»æ¨¡å‹å‚æ•°ä»¥é™ä½è®­ç»ƒ/æ¨ç†æˆæœ¬ï¼‰ã€‚</li>
</ol>
<hr>
<h2 id="-observations--analysis">ğŸ” Observations / Analysis<a hidden class="anchor" aria-hidden="true" href="#-observations--analysis">#</a></h2>
<p><img loading="lazy" src="./pic/C2C/f34t12.png"></p>
<ul>
<li>
<p><strong>Oracleï¼ˆç¼“å­˜å¯ŒåŒ–ï¼‰å®éªŒ</strong>ï¼šæŠŠ few-shot ç¤ºä¾‹ $E$ å’Œé—®é¢˜ $X$ ä¸€èµ· prefillï¼Œç„¶åä¸¢å¼ƒ $E$ çš„ cache ç‰‡æ®µï¼Œåªä¿ç•™å¯¹é—®é¢˜ $X$ å¯¹é½çš„ sliceï¼ˆå³ Oracle cache enrichmentï¼‰ï¼š</p>
<p>$$
C^*(X) = C_{E \oplus X}[|E| : |E| + |X|]
$$</p>
<p>åœ¨ä¸å¢é•¿ $|X|$ çš„æƒ…å†µä¸‹èƒ½æ˜¾è‘—æå‡å‡†ç¡®ç‡ï¼Œè¯´æ˜ã€Œä¸Šä¸‹æ–‡å½±å“äº†å¦‚ä½•æŠŠé—®é¢˜ç¼–ç åˆ° KV-Cache ä¸­ã€ï¼Œè€Œè¿™å¹¶éä»…ä»…æ˜¯å› ä¸ºé¢å¤– token çš„æ³¨æ„åŠ›èŒƒå›´ã€‚è¯¦è§ Table 1 ä¸ç›¸å…³è®¨è®ºã€‚</p>
<p>å…¶ä¸­ï¼Œ$C(\cdot)$ è¡¨ç¤º prefill åå¾—åˆ°çš„ per-token KV-Cacheã€‚</p>
</li>
<li>
<p><strong>Cache è½¬æ¢å®éªŒ</strong>ï¼šä½¿ç”¨ 3-layer MLP å°†å¤§æ¨¡å‹ï¼ˆQwen3-4Bï¼‰çš„ KV æ˜ å°„åˆ°å°æ¨¡å‹ï¼ˆQwen3-0.6Bï¼‰è¡¨ç¤ºç©ºé—´ï¼Œt-SNE æ˜¾ç¤ºæ˜ å°„åçš„ cache è½å…¥æ¥æ”¶æ¨¡å‹ KV ç©ºé—´å†…éƒ¨ï¼Œä½†åªè¦†ç›–å…¶å­é›†ï¼Œè¯´æ˜å¯è½¬æ¢ä½†ä¸å®Œå…¨ç­‰ä»·ï¼ˆä¿¡æ¯å­é›†åŒ–ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å±‚çº§å·®å¼‚</strong>ï¼šä¸åŒå±‚å¯¹ cache enrichment çš„å“åº”ä¸åŒï¼ˆAppendix A.2.1 å±•ç¤ºå•å±‚æ›¿æ¢ç»“æœï¼Œéƒ¨åˆ†å±‚æœ‰æ­£æ”¶ç›Šï¼Œéƒ¨åˆ†å±‚è´Ÿæ”¶ç›Šï¼‰ï¼Œè¿™ç›´æ¥ä¿ƒæˆäº†è®¾è®¡ä¸­ä½¿ç”¨ per-layer gate çš„åŠ¨æœºã€‚</p>
</li>
<li>
<p><strong>äº’è¡¥æ­£ç¡®é›†</strong>ï¼šä¸åŒæ¨¡å‹åœ¨åŒä¸€ benchmark ä¸Šçš„æ­£ç¡®ç­”æ¡ˆé›†åˆæœ‰è¾ƒå°‘é‡å ï¼ˆVenn å›¾ Figure 7ï¼‰ï¼Œè¯´æ˜å¤šæ¨¡å‹é—´å­˜åœ¨äº’è¡¥æ€§ï¼Œè‹¥èƒ½æœ‰æ•ˆèåˆåˆ™èƒ½æé«˜æ€»ä½“æ­£ç¡®ç‡ã€‚</p>
</li>
</ul>
<hr>
<h2 id="-methods">ğŸ§  Methods<a hidden class="anchor" aria-hidden="true" href="#-methods">#</a></h2>
<blockquote>
<p>æ¦‚è§ˆï¼šæå‡º <strong>Cache-to-Cache (C2C)</strong> â€”â€” ç”¨ä¸€ä¸ªç¥ç»æ¨¡å—ï¼ˆCache Fuserï¼‰æŠŠ Sharerï¼ˆæ¥æºæ¨¡å‹ï¼‰çš„ KV-Cache æŠ•å½±åˆ° Receiverï¼ˆç›®æ ‡æ¨¡å‹ï¼‰çš„è¡¨ç¤ºç©ºé—´å¹¶æŒ‰å±‚æ®‹å·®åœ°èåˆåˆ° Receiver çš„åŸå§‹ KV-Cacheï¼Œä»è€Œåœ¨ decode é˜¶æ®µè®© Receiver åˆ©ç”¨ä¸¤è€…çš„è¯­ä¹‰è¡¨ç¤ºï¼Œè€Œä¸å¿…é€šè¿‡æ–‡å­—ä¸­ä»‹ã€‚</p>
</blockquote>
<hr>
<h3 id="31-é¢„å¤‡">3.1 é¢„å¤‡<a hidden class="anchor" aria-hidden="true" href="#31-é¢„å¤‡">#</a></h3>
<p>è¾“å…¥ token åºåˆ—ï¼š</p>
<p>$$
X[0:n] = [x_0, x_1, \dots, x_{n-1}]
$$</p>
<p>prefill å LLM ç”Ÿæˆ per-token KV-Cacheï¼š</p>
<p>$$
C(X[0:n]) = [c_0, c_1, \dots, c_{n-1}] \in \mathbb{R}^{n \times d}
$$</p>
<p>å…¶ä¸­ $d$ ä¸º KV å‘é‡ç»´åº¦ï¼ˆå°†å„å±‚/å„å¤´çš„ K/V å±•å¹³ï¼‰ã€‚</p>
<p>Decode æ—¶é¢„æµ‹ä¸‹ä¸€ä¸ª tokenï¼š</p>
<p>$$
y_{i+1} = P\big(y_i \mid C(X) \oplus C(Y[0:i])\big)
$$</p>
<p>å…¶ä¸­ $\oplus$ è¡¨ç¤ºåºåˆ—çº§æ‹¼æ¥ã€‚</p>
<hr>
<h3 id="32-c2c-æ€»ä½“æ¡†æ¶">3.2 C2C æ€»ä½“æ¡†æ¶<a hidden class="anchor" aria-hidden="true" href="#32-c2c-æ€»ä½“æ¡†æ¶">#</a></h3>
<p>åœ¨ prefill é˜¶æ®µï¼Œä»¤ Fuser æ¨¡å— $F_n$ å°† Receiver ç¬¬ $n$ å±‚çš„ cache $C_n(X)$ å’Œ Sharer å¯¹åº”å±‚ $C^S_{G(n)}(X)$ï¼ˆå±‚æ˜ å°„å‡½æ•°ä¸º $G$ï¼‰èåˆï¼Œå¾—åˆ° fused cacheï¼š</p>
<p>$$
C^F = {, F_n(C_n(X), C^S_{G(n)}(X)) ,}_{n=1}^N
$$</p>
<p>Decode æ—¶ä½¿ç”¨ fused cacheï¼š</p>
<p>$$
y_{i+1} = P\big(y_i \mid C^F(X) \oplus C(Y[0:i])\big)
$$</p>
<p>ï¼ˆå‚è§è®ºæ–‡å…¬å¼ (3) å’Œ (4)ï¼‰</p>
<hr>
<h3 id="33-c2c-fuser-ç»“æ„figure-5">3.3 C2C Fuser ç»“æ„ï¼ˆFigure 5ï¼‰<a hidden class="anchor" aria-hidden="true" href="#33-c2c-fuser-ç»“æ„figure-5">#</a></h3>
<p><img loading="lazy" src="./pic/C2C/figure5.png">
æ€»ä½“ä¸‰æ¨¡å—è®¾è®¡ï¼ˆResidual Integrationï¼‰ï¼š</p>
<p><strong>Projection â†’ Dynamic Weighting â†’ Learnable Gate</strong>ï¼ˆGumbel-sigmoid è®­ç»ƒ â†’ äºŒå€¼åŒ–æ¨ç†ï¼‰</p>
<h4 id="1-projection-module">(1) Projection Module<a hidden class="anchor" aria-hidden="true" href="#1-projection-module">#</a></h4>
<p>å°† Receiver çš„ KV ä¸ Sharer çš„ KV åšæ‹¼æ¥ï¼ˆconcatenateï¼‰ï¼Œç»è¿‡ä¸€å±‚æˆ–å¤šå±‚æŠ•å½±ï¼ˆä¾‹å¦‚çº¿æ€§å±‚æˆ–å° MLPï¼‰ä»¥ç»Ÿä¸€ç»´åº¦ / æ˜ å°„è¡¨ç¤ºï¼›ç´§æ¥ç€åš feature fusionï¼ˆå¯èƒ½æ˜¯å†ä¸€å±‚çº¿æ€§/FFN æˆ–è·¨-head é‡ç»„ï¼‰ã€‚ï¼ˆè®ºæ–‡åœ¨ Appendix ä¹Ÿæåˆ° C2C-C æ›´å¤æ‚çš„ variantï¼Œä¼šå…ˆç”¨ä¸‰å±‚ MLP æŠ•å½±ï¼‰ã€‚</p>
<h4 id="2-dynamic-weightingè¾“å…¥æ„ŸçŸ¥çš„-head-modulation">(2) Dynamic Weightingï¼ˆè¾“å…¥æ„ŸçŸ¥çš„ head modulationï¼‰<a hidden class="anchor" aria-hidden="true" href="#2-dynamic-weightingè¾“å…¥æ„ŸçŸ¥çš„-head-modulation">#</a></h4>
<p>æŒ‰ attention-head çº§åˆ«åšè¾“å…¥ç›¸å…³çš„é‡æƒé‡ï¼ˆhead-wise modulationï¼‰ï¼Œç›®çš„æ˜¯æ ¹æ®å½“å‰è¾“å…¥åŠ¨æ€è°ƒæ•´ Sharer æä¾›ä¿¡æ¯çš„å½±å“åŠ›ï¼ˆé¿å…ç›²ç›®è¦†ç›–ï¼‰ã€‚è®ºæ–‡ç§°ä¸º â€œinput-aware head modulationâ€ã€‚</p>
<h4 id="3-learnable-gateå¯è®­ç»ƒé—¨æ§">(3) Learnable Gateï¼ˆå¯è®­ç»ƒé—¨æ§ï¼‰<a hidden class="anchor" aria-hidden="true" href="#3-learnable-gateå¯è®­ç»ƒé—¨æ§">#</a></h4>
<p>æ¯å±‚æœ‰ä¸€ä¸ªå¯å­¦ä¹  gate å€¼ï¼Œç”¨ Gumbel-Sigmoidï¼ˆå¹¶åœ¨è®­ç»ƒæ—¶åšæ¸©åº¦ annealingï¼‰ä»å¯å¾®åˆ†è½¯é€‰æ‹©è¿‡æ¸¡åˆ°æ¨ç†æœŸçš„ç¡¬äºŒå€¼å†³å®šï¼ˆæ˜¯å¦æŠŠè¯¥å±‚çš„ fused cache æ³¨å…¥ï¼‰ã€‚
è¿™è§£å†³äº†å“ªäº›å±‚åº”è¯¥æ³¨å…¥çš„é—®é¢˜å¹¶èƒ½å­¦åˆ°å±‚é€‰æ‹©ç­–ç•¥ã€‚</p>
<hr>
<h3 id="34-model-alignment">3.4 Model Alignment<a hidden class="anchor" aria-hidden="true" href="#34-model-alignment">#</a></h3>
<ul>
<li>
<p><strong>Token å¯¹é½</strong>ï¼šå°† Receiver token è§£ç ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨ Sharer tokenizer é‡æ–°ç¼–ç ï¼ˆre-encodeï¼‰ï¼›è‹¥å‡ºç° one-to-manyï¼Œç”¨ â€œmaximal-coverage selectionâ€ ï¼ˆé€‰æ‹©å­—ç¬¦ä¸²è¦†ç›–æœ€é•¿çš„ tokenï¼‰ä½œä¸ºé»˜è®¤ç­–ç•¥ï¼ˆè®ºæ–‡è§‚å¯Ÿä¸¤ç§ç­–ç•¥å·®å¼‚ä¸å¤§ä½† maximal-coverage æ›´å®‰å…¨ï¼‰ã€‚å¯¹ templateï¼ˆç³»ç»Ÿè§’è‰²/æ ¼å¼åŒ– tokensï¼‰éƒ¨åˆ†ç”¨ padding åŒ¹é…é•¿åº¦ã€‚</p>
</li>
<li>
<p><strong>Layer å¯¹é½ï¼ˆLayer mappingï¼‰</strong>ï¼šé‡‡ç”¨ <strong>terminal alignment</strong>ï¼ˆä»è¾“å‡ºä¾§å¼€å§‹å¯¹é½ï¼šæœ€åä¸€å±‚å¯¹æœ€åä¸€å±‚ã€å€’æ•°ç¬¬äºŒå¯¹å€’æ•°ç¬¬äºŒï¼Œä»¥æ­¤ç±»æ¨ï¼‰ï¼Œä½œè€…åœ¨ Appendix æ¯”è¾ƒäº† depth-normalized alignment å¹¶é€‰æ‹© terminal alignmentï¼Œå› ä¸º empirical æ•ˆæœæ›´å¥½ã€‚</p>
</li>
</ul>
<hr>
<h3 id="35-è®­ç»ƒæ–¹æ¡ˆ">3.5 è®­ç»ƒæ–¹æ¡ˆ<a hidden class="anchor" aria-hidden="true" href="#35-è®­ç»ƒæ–¹æ¡ˆ">#</a></h3>
<p>å†»ç»“ Sharer å’Œ Receiver æ¨¡å‹å‚æ•°ï¼Œä»…è®­ç»ƒ C2C æ¨¡å—ï¼ˆFuserï¼‰ã€‚
ç›‘ç£ç›®æ ‡æ˜¯ Receiver åœ¨ä½¿ç”¨ fused cache ä¸‹çš„ next-token é¢„æµ‹ï¼ˆSFT é£æ ¼ï¼‰ï¼Œå³æœ€å°åŒ–æ ‡å‡†äº¤å‰ç†µï¼š</p>
<p>$$
\mathcal{L}<em>{\text{C2C}} = -\sum_i \log P</em>\theta(y_i | C^F(X), Y[0:i-1])
$$</p>
<p>è®­ç»ƒæ­¥éª¤ï¼š</p>
<ol>
<li>Forwardï¼šä¸¤æ¨¡å‹äº§ç”Ÿ cache</li>
<li>Fusionï¼šC2C ç”Ÿæˆ fused cache</li>
<li>Supervisionï¼šReceiver ç”¨ fused cache decodeï¼Œloss åä¼ å› C2C</li>
</ol>
<p>è®­ç»ƒæ•°æ®ï¼šä¸»è¦ä½¿ç”¨ OpenHermes-2.5 çš„å‰ 500k æ ·æœ¬è®­ç»ƒï¼›ä¼˜åŒ–å™¨ä¸è¶…å‚ï¼š
$$
\text{lr}=1\times10^{-4}, \text{ weight decay}=0.01, \text{warmup}=10%, T_{init}=1.0 \rightarrow T_{final}=0.001
$$
å›ºå®šéšæœºç§å­ 42ã€‚</p>
<hr>
<h2 id="-evaluation">ğŸ“Š Evaluation<a hidden class="anchor" aria-hidden="true" href="#-evaluation">#</a></h2>
<h3 id="æ•°æ®é›†ä¸è®¾ç½®">æ•°æ®é›†ä¸è®¾ç½®<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®é›†ä¸è®¾ç½®">#</a></h3>
<ul>
<li><strong>Benchmarks</strong>ï¼šOpenBookQA, MMLU-Redux, ARC-Challenge (ARC-C), C-Evalï¼ˆä¸­æ–‡ï¼‰ä»¥åŠ LongBenchï¼ˆé•¿ä¸Šä¸‹æ–‡ä»»åŠ¡ï¼‰ã€‚</li>
<li><strong>è®¾ç½®</strong>ï¼šzero-shotï¼Œgreedy è§£ç ï¼ˆtemperature=0ï¼‰ï¼Œå¤šé€‰é¢˜æœ€å¤§ç”Ÿæˆé•¿åº¦ = 64ã€‚</li>
<li><strong>è®¾å¤‡</strong>ï¼šNVIDIA A100ï¼Œbatch=1ã€‚</li>
</ul>
<hr>
<h3 id="å¯¹æ¯”åŸºçº¿">å¯¹æ¯”åŸºçº¿<a hidden class="anchor" aria-hidden="true" href="#å¯¹æ¯”åŸºçº¿">#</a></h3>
<ul>
<li>Receiver å•ç‹¬è¿è¡Œï¼ˆbaselineï¼‰</li>
<li>Sharer å•ç‹¬è¿è¡Œï¼ˆå¯¹æ¯”ï¼‰</li>
<li>Query-level routingï¼ˆå°†éš¾é¢˜è·¯ç”±åˆ°å¼ºæ¨¡å‹ï¼‰</li>
<li>Text-to-Textï¼ˆT2Tï¼‰ï¼šSharer ç”Ÿæˆ â€œåˆ†æ/å…³é”®ä¿¡æ¯â€ æ–‡æœ¬æ‹¼æ¥åˆ° Receiver è¾“å…¥ä¸­ã€‚</li>
</ul>
<hr>
<p><img loading="lazy" src="./pic/C2C/table3.png">
<img loading="lazy" src="./pic/C2C/f6t45.png">
<img loading="lazy" src="./pic/C2C/t67.png"></p>
<h3 id="æ ¸å¿ƒç»“æœæ€»ç»“">æ ¸å¿ƒç»“æœæ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#æ ¸å¿ƒç»“æœæ€»ç»“">#</a></h3>
<ul>
<li><strong>C2C ç›¸è¾ƒäº Receiver-only</strong>ï¼šå¹³å‡æå‡ <strong>8.5â€“11%</strong>ï¼ˆä¸åŒè¡¨è¿°èŒƒå›´ 8.5â€“11.9%ï¼‰ã€‚</li>
<li><strong>C2C ç›¸è¾ƒäº T2T</strong>ï¼šå¹³å‡æå‡ <strong>3â€“5%</strong>ï¼Œä¸”æ¨ç†å»¶è¿Ÿå¹³å‡çº¦ä¸º <strong>T2T çš„ 1/2</strong>ã€‚</li>
<li><strong>é•¿ä¸Šä¸‹æ–‡ä»»åŠ¡ï¼ˆLongBenchï¼‰</strong>ï¼šC2C æŒç»­ä¼˜äº T2Tï¼Œå°¤å…¶åœ¨ strongâ†’weak è®¾å®šä¸­æ˜¾è‘—æ¢å¤å¼±æ¨¡å‹æ€§èƒ½ï¼ˆPGR æŒ‡æ ‡å¤§å¹…æé«˜ï¼‰ã€‚</li>
</ul>
<hr>
<h3 id="ablation">Ablation<a hidden class="anchor" aria-hidden="true" href="#ablation">#</a></h3>
<p>å»æ‰ fuseï¼ˆä»… projectionï¼‰æ€§èƒ½æœ€å·®ï¼›åŠ å…¥ fuse åå¤§å¹…æå‡ï¼›å†åŠ å…¥ gateï¼ˆå®Œæ•´ C2Cï¼‰è¿›ä¸€æ­¥æå‡çº¦ <strong>3%</strong>ï¼ˆè§ Table 7ï¼‰ã€‚
è¯´æ˜ Projection + Fuse + Gate ä¸‰è€…ååŒä½œç”¨æ˜¾è‘—ã€‚</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">JJ&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
